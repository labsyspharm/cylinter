# TOP-LEVEL PROGRAM CONFIGURATIONS:

in_dir: /Users/<user>/Desktop/exemplar-002
# path to top-level directory containing mcmicro-derived ome.tiffs,
# segmentation masks, and corresponding SS data files (csv files),


out_dir: /Users/<user>/Desktop/output
# path to top-level output directory (location is arbitrarily chosen)
# random_sample_size: analyze a randomly chosen percentage of the SS data
# chosen (range: 0.0-1.0)

random_sample_size: 1.0

mask_object: cellMask
# this parameter corresponds to the column headers in CSV files
# that are generated by mcmicro and represents the particular
# cell feature used for calculating mean cell signal intensity
# (e.g. cellMask, nucleiMask, cellRingMask ...)

sample_metadata:
  unmicst-1: ["Gastrointestinal stromal tumor", "STOMACH", "CANCER-TRUE", 1]
  unmicst-2: ["Non-neoplastic colon", "COLON", "CANCER-FALSE", 1]
  unmicst-3: ["Meningioma", "BRAIN", "CANCER-TRUE", 1]
  unmicst-4: ["Meningioma", "BRAIN", "CANCER-TRUE", 2]
# Sample metadata dictionary. Keys are sample names (str dtype). Values are lists:
# First element: full name of experimental condition (str dtype).
# Second element: abbreviated name of experimental condition (str dtype).
# Third element: comma-delimited string of binary declarations for pairwise statistical comparisons (str dytpe).
# Forth: replicate number for biological/technical replicates (int dtype)

samples_to_exclude: []
# list of samples (str dtype) to censor from the analysis

markers_to_exclude: ["AF488",
                     "AF555",
                     "AF647",
                     "A488_background",
                     "A555_background",
                     "A647_background"]
#  list of markers (str dtype) to censor from the analysis


# CLASS MODULE CONFIGURATIONS:
###############################################################################
# setContrast —

view_sample: "2"
# name of sample (equivalent to sample metadata keys)
# on which to assign contrast adjustments to be applied
# to all tissues in the analysis.

###############################################################################
# selectROIs —

delint_mode: False
# (Boolean) Whether to drop (True) or keep (False) selected ROI indices.
# True is equivalent to negative selection;
# False, positive selection.

show_ab_channels: False
# (Boolean) If True open image with all associated
# marker channels (memory maybe be limiting).
# If False show cycle1 DNA only.

###############################################################################
# crossCycleCorrelation —

cutoffAxis: 'x'
# which axis of the log10(ratio) histograms to apply cutoff for
# data inclusion in downstream analyses

log_ratio_rnge: null
# Lower and upper cutoffs on log(cycle ratio) values
# for histogram plotting (tuple of floats (or None)).
# Symmetrical values around zero allow for a diverging
# colormap to show tissue areas with increasing (green)
# and decreasing (pink) DNA signal intensity values between
# successive imaging cycles. Symmetrical cutoffs centered
# at local minima between two modes allows for the colormap
# to show tissue area_mask with different degrees of
# cross-cycle correlation of DNA intensity.

###############################################################################
# pruneOutliers —

hexbins: False
# (Boolean) If True, use hexbins to plot single-cell signal intensities
# instead of scatter plots for shortening rendering time.

hexbin_grid_size: 20
# (int) Not used if hexbins is False. Higher values increase
# data point resolution.

###############################################################################
# PCA module —

channelExclusionsPCA: []
# (list of strings) immunomarkers to exclude from PCA analysis

samplesToRemovePCA: []
# (list of strings) samples to remove from PCA and downstream modules

dimensionPCA: 2
# (int) number of PCs to compute (currently expects 2)

pointSize: 90.0
# scatter point size for plotting sample score values

normalize: True
# scale input vectors individually to unit norm (recommended)

labelPoints: True
# annotate scatter points with sample name abbreviations

distanceCutoff: 0.02
# max distance between observations in PC space
# (as determined by via scipy.spatial.distance.pdist) to share
# a common label in the PCA plot.

samplesToSilhouette: []
# (list of strings) list of sample names to grey out,
# send to back, and block annotations for specified samples.
# Maybe helpful for increasing visual clarify of PCA
# plots with many data points.

###############################################################################
# clustering module —

embeddingAlgorithm: 'UMAP'

channelExclusionsClustering: []
# (list of strings) immunomarkers to exclude from clustering

samplesToRemoveClustering: []
# (list of strings) samples to remove from clustering and downstream modules
# If True, applied before tissue cell count normalization ("normalizeTissueCounts"; see below)

normalizeTissueCounts: True
# compute sample weights to normalize the number of cells to be clustered per tissue

fracForEmbedding: 0.1
# fraction of total cells to be used in clustering

dimensionEmbedding: 2
# dimension of the embedding (currently expects 2)

metric: "euclidean"
# string allowed by scipy.spatial.distance.pdist for its metric
# parameter, or a metric listed in pairwise.PAIRWISE_DISTANCE_FUNCTIONS.

#####
# tSNE (https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html)
perplexity: 50.0
# related to the number of nearest neighbors used in other
# manifold learning algorithms. Larger datasets usually require
# larger perplexity. Different values can result in significantly
# different results.

earlyExaggeration: 12.0
# for larger values, the space between natural clusters
# will be larger in the embedded space.

learningRateTSNE: 200.0
# tSNE learning rate (10.0, 1000.0)

random_state: 5
# integer, determines the random number generator
# for reproducible results across multiple function calls.

#####
# UMAP (API: https://umap-learn.readthedocs.io/en/latest/api.html)
nNeighbors: 6
# The size of local neighborhood (in terms of number of
# neighboring sample points) used for manifold approximation.
# Larger values result in more global views of the manifold,
# while smaller values result in more local data being preserved.
# In general values should be in the range 2 to 100.

learningRateUMAP: 0.4
# The initial learning rate for the embedding optimization.

minDist: 0.05
# The effective minimum distance between embedded points.
# Smaller values will result in a more clustered/clumped
# embedding where nearby points on the manifold are drawn
# closer together, while larger values will result on a more
# even dispersal of points. The value should be set relative
# to the spread value, which determines the scale at which
# embedded points will be spread out.

repulsionStrength: 6.0
# Weighting applied to negative samples in low dimensional
# embedding optimization. Values higher than one will
# result in greater weight being given to negative samples.

###############################################################################
# frequencyStats —

controlGroups: ["CANCER-FALSE"]
# (list of strings) control group labels (third elements in sample_metadata values)

denominatorCluster: null
# (int or null) cluster to be used as denominator when computing
# cell frequency ratios. Use null initially.

FDRCorrection: False
# (Boolean) if True, compute false discovery rate q-vals.
# Otherwise compute uncorrected p-vals only

###############################################################################
# curateThumbnails —

numThumbnails: 10
# number of cells from each cluster to be chosen at random for creating thumbnail gallery

squareWindowDimension: 35
# number of pixels from the reference centroid in the x and y directions

###############################################################################
# clusterBoxplots —

bonferroniCorrection: False
# (Boolean) if True, compute Bonferroni q-vals.
# Otherwise compute uncorrected p-vals

###############################################################################
# spatialAnalysis —

cropDict: {'cd13': ('top', 10000), 'hfd3': ('bottom', 11000), 'hfd4': ('top', 8000), 'hfd8': ('bottom', 7500), 'hfd9': ('top', 9500), 'hfd11': ('bottom', 6600), 'hfd12': ('top', 9000), 'hfd13': ('top', 7000),}
# vertical crop coordinate (numpy row) and sub-image to use for
# t-CyCIF images containing more than one tissue section

spatialDict1: {'aco2': 0.07, 'glut1': 0.25}
# cutoff for pixel-level protein signal intensities

spatialDict2: {'TCF1': 0, 'CD8T': 1}
# map of cell state call to cluster for cell states of interest

radiusRange: [40, 600]
# range of radii (in pixels) for Poisson-disc sampling
